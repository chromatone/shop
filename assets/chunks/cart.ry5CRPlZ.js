import{V as A,q as s,W as S,X as l,Y as p,Z as G,$ as w,a0 as h}from"./framework.yFqBpdxL.js";import{d as y}from"./shop.data.euSj2fB6.js";var L="https://js.stripe.com/v3",B=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,M="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",N=function(){for(var e=document.querySelectorAll('script[src^="'.concat(L,'"]')),r=0;r<e.length;r++){var n=e[r];if(B.test(n.src))return n}return null},E=function(e){var r=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(L).concat(r);var a=document.head||document.body;if(!a)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return a.appendChild(n),n},R=function(e,r){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"2.2.2",startTime:r})},c=null,f=null,v=null,I=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},P=function(e,r){return function(){window.Stripe?e(window.Stripe):r(new Error("Stripe.js not available"))}},V=function(e){return c!==null?c:(c=new Promise(function(r,n){if(typeof window>"u"||typeof document>"u"){r(null);return}if(window.Stripe&&e&&console.warn(M),window.Stripe){r(window.Stripe);return}try{var a=N();if(a&&e)console.warn(M);else if(!a)a=E(e);else if(a&&v!==null&&f!==null){var u;a.removeEventListener("load",v),a.removeEventListener("error",f),(u=a.parentNode)===null||u===void 0||u.removeChild(a),a=E(e)}v=P(r,n),f=I(n),a.addEventListener("load",v),a.addEventListener("error",f)}catch(d){n(d);return}}),c.catch(function(r){return c=null,Promise.reject(r)}))},g=function(e,r,n){if(e===null)return null;var a=e.apply(void 0,r);return R(a,n),a},m=Promise.resolve().then(function(){return V(null)}),C=!1;m.catch(function(t){C||console.warn(t)});var K=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];C=!0;var a=Date.now();return m.then(function(u){return g(u,r,a)})};function U(t,e,r){if(typeof t=="function"||A(t))return s(()=>S(l(t),l(e),l(r)));const n=p(t);return s({get(){return n.value=S(n.value,l(e),l(r))},set(a){n.value=S(a,l(e),l(r))}})}const F=["AC","AD","AE","AF","AG","AI","AL","AM","AO","AQ","AR","AT","AU","AW","AX","AZ","BA","BB","BD","BE","BF","BG","BH","BI","BJ","BL","BM","BN","BO","BQ","BR","BS","BT","BV","BW","BY","BZ","CA","CD","CF","CG","CH","CI","CK","CL","CM","CN","CO","CR","CV","CW","CY","CZ","DE","DJ","DK","DM","DO","DZ","EC","EE","EG","EH","ER","ES","ET","FI","FJ","FK","FO","FR","GA","GB","GD","GE","GF","GG","GH","GI","GL","GM","GN","GP","GQ","GR","GS","GT","GU","GW","GY","HK","HN","HR","HT","HU","ID","IE","IL","IM","IN","IO","IQ","IS","IT","JE","JM","JO","JP","KE","KG","KH","KI","KM","KN","KR","KW","KY","KZ","LA","LB","LC","LI","LK","LR","LS","LT","LU","LV","LY","MA","MC","MD","ME","MF","MG","MK","ML","MM","MN","MO","MQ","MR","MS","MT","MU","MV","MW","MX","MY","MZ","NA","NC","NE","NG","NI","NL","NO","NP","NR","NU","NZ","OM","PA","PE","PF","PG","PH","PK","PL","PM","PN","PR","PS","PT","PY","QA","RE","RO","RS","RU","RW","SA","SB","SC","SE","SG","SH","SI","SJ","SK","SL","SM","SN","SO","SR","SS","ST","SV","SX","SZ","TA","TC","TD","TF","TG","TH","TJ","TK","TL","TM","TN","TO","TR","TT","TV","TW","TZ","UA","UG","US","UY","UZ","VA","VC","VE","VG","VN","VU","WF","WS","XK","YE","YT","ZA","ZM","ZW","ZZ"],{delivery_types:W}=y,D="pk_live_51M1WfLBJnUXQERocrGtVUDvfIdzMmecoAClLVFLSi2VG2cNF2kS6bVsR4uUVtMYvusv4lkBMaDuOzgVJUuNMWndm00CVS3obG3",O=5;p(!1);const T=p(!1),o=G("shopping-cart",{}),i=w({current:G("delivery-way","regular"),selected:s(()=>i.ways[i.current]),needed:s(()=>{let t=!1;for(let e in o.value)t=t||!o.value[e].digital;return t}),ways:W}),q=s(()=>{var e,r;let t=0;for(let n in o.value)t+=Number((r=(e=o.value)==null?void 0:e[n])==null?void 0:r.quantity);return t}),H=s(()=>{var e,r,n,a,u;let t=0;for(let d in o.value)t+=Number((r=(e=o.value)==null?void 0:e[d])==null?void 0:r.price)*Number((a=(n=o.value)==null?void 0:n[d])==null?void 0:a.quantity);return i.needed&&(t+=(u=i==null?void 0:i.selected)==null?void 0:u.price),t});h(o,t=>{Object.keys(t).length<=0&&(T.value=!1);for(let e in t)t[e].quantity<=0&&delete o.value[e]},{deep:!0});function Y(t,{id:e,price:r,digital:n,path:a}){o.value[e]?o.value[e].quantity++:o.value[e]={id:e,title:t,price:r,quantity:U(1,0,O).value,digital:n,path:a},T.value=!0}async function J(){const t=await K(D),e=[];for(let n in o.value)e.push({price:n,quantity:o.value[n].quantity});i.needed&&e.push({price:i.selected.id,quantity:1});const r={lineItems:e,mode:"payment",successUrl:"https://shop.chromatone.center/success/",cancelUrl:"https://shop.chromatone.center/cancel/",shippingAddressCollection:i.needed?{allowedCountries:F}:void 0};try{await(t==null?void 0:t.redirectToCheckout(r))}catch(n){console.log(n),alert(`checkout failed, ${n}`)}}export{q as a,J as b,o as c,i as d,Y as e,T as o,H as t};
